/* style.css */

/* 1. 배경 및 레이아웃 설정 */
body { 
    margin: 0; 
    background-color: #000; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    height: 100dvh; 
    width: 100vw;
    color: white; 
    font-family: 'Arial', sans-serif; 
    overflow: hidden; 
    touch-action: none; 
}

/* 2. 게임기 본체: 비율 유지 및 자동 크기 조절 */
#game-container {
    position: relative;
    aspect-ratio: 450 / 700; 
    
    /* [수정됨] 기존 height: 100% 대신 아래 설정 사용 */
    /* 너비를 화면에 꽉 채우되, 높이가 화면을 넘어가면 높이에 맞춤 */
    width: 100%; 
    height: auto; 
    
    max-width: 100%;
    max-height: 100%;
    
    background-color: #222; 
    box-shadow: 0 0 50px rgba(0,0,0,0.8); 
    overflow: hidden;
    /* 폰트 사이즈 기준점 설정 (화면 크기에 비례) */
    font-size: 2.5vh; 
}

/* 3. 캔버스 */
canvas { 
    width: 100%; 
    height: 100%; 
    display: block;
    image-rendering: pixelated; 
    background-color: #87ceeb;
    
    /* [안전장치] 혹시 모를 비율 깨짐 방지 */
    object-fit: contain; 
}

/* UI 오버레이 공통 설정 */
.overlay-screen {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.9);
    display: flex; flex-direction: column; justify-content: center; align-items: center; 
    z-index: 100;
    box-sizing: border-box;
    padding: 20px; 
}

/* 인게임 UI바 */
#ui { 
    position: absolute; top: 2%; left: 0; width: 100%; 
    text-align: center; pointer-events: none; z-index: 10; display: none; 
}

/* 텍스트 크기 반응형 조정 (vmin 사용) */
h1 { font-size: 5vmin; margin: 1vh 0; text-shadow: 1px 1px 2px white; color: #333; }
h2 { font-size: 4vmin; }
h3 { font-size: 3.5vmin; margin: 0.5vh 0; color: #333; text-shadow: 1px 1px 2px white; }

.bar-container { width: 60%; height: 2vh; background-color: #444; margin: 0.5vh auto; border: 2px solid #fff; position: relative; }
#hp-bar { width: 100%; height: 100%; background-color: #00f0ff; transition: width 0.2s; }
#xp-bar { width: 0%; height: 100%; background-color: #ffd700; transition: width 0.2s; }
#boss-ui { display: none; margin-top: 1vh; } 
#boss-hp-bar { width: 100%; height: 100%; background-color: #ff00ff; transition: width 0.2s; }
.bar-text { position: absolute; top: 0; left: 0; width: 100%; font-size: 2vmin; line-height: 2vh; color: black; font-weight: bold; }
.info-text { font-size: 3vmin; color: #333; margin-top: 1vh; font-weight: bold; text-shadow: 1px 1px 0px white;}

/* 타이틀 화면 */
#title-screen { display: flex; text-align: center; }
.main-title { 
    font-size: 10vmin; 
    color: #00f0ff; 
    text-shadow: 0 0 20px #00f0ff; 
    margin-bottom: 5vh; 
    font-weight: bold; 
    letter-spacing: 2px; 
}
.start-btn { 
    padding: 2vh 6vw;      
    font-size: 4.5vmin;    
    background: #333; 
    color: white; 
    border: 3px solid #00f0ff; 
    cursor: pointer; 
    transition: 0.2s; 
    font-weight: bold; 
    white-space: nowrap;
    max-width: 90%;        
    overflow: hidden;
    text-overflow: ellipsis;
}
.start-btn:hover { background: #00f0ff; color: black; box-shadow: 0 0 20px #00f0ff; }
.start-btn:disabled { border-color: #555; color: #555; cursor: not-allowed; box-shadow: none; background: #222; }

/* 로드아웃 화면 */
#loadout-screen { display: none; justify-content: flex-start; padding-top: 5vh; }
.loadout-container { 
    display: flex; flex-direction: column; align-items: center; 
    gap: 2vh; margin-bottom: 2vh; width: 100%; flex: 1; overflow: hidden; 
}
.selection-slots { display: flex; gap: 5%; margin-bottom: 1vh; width: 80%; justify-content: center; }

/* 슬롯 크기 반응형 변경 */
.slot { 
    width: 45%; 
    aspect-ratio: 100/120; 
    height: auto;
    border: 3px dashed #555; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; 
    cursor: pointer; background: #222; transition: 0.2s; 
}
.slot.active { border-color: #00f0ff; box-shadow: 0 0 15px rgba(0, 240, 255, 0.3); }
.slot.filled { border-style: solid; border-color: white; background: #333; }
.slot-label { font-size: 2.5vmin; color: #aaa; margin-bottom: 1vh; font-weight:bold; }
.slot-icon { width: 6vmin; height: 6vmin; background: #333; border-radius: 50%; margin-bottom: 0.5vh; }
.slot-name { font-size: 3vmin; font-weight: bold; color: white; text-align: center;}

/* 파츠 그리드 반응형 */
.part-grid { 
    display: grid; 
    grid-template-columns: repeat(4, 1fr); 
    gap: 2vmin; 
    width: 90%;
    max-height: 35vh; 
    overflow-y: auto; 
    padding: 10px; 
    background: rgba(0,0,0,0.3); 
    border-radius: 10px; 
    -webkit-overflow-scrolling: touch; 
}
.part-grid::-webkit-scrollbar { width: 4px; }
.part-grid::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }

.mini-card { 
    width: 100%; 
    aspect-ratio: 60/80;
    height: auto;
    background: #444; border: 2px solid #777; 
    cursor: pointer; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; 
    padding: 2px; transition: 0.2s; 
    box-sizing: border-box;
}
.mini-card:hover { border-color: white; background: #555; }
.mini-card.selected { border-color: #ffff00; background: #666; box-shadow: 0 0 10px #ffff00; }
.mini-card.in-use { opacity: 0.3; border-color: #333; pointer-events: none; }
.mini-icon { width: 4vmin; height: 4vmin; margin-bottom: 0.5vh; }
.mini-name { font-size: 2vmin; color: white; text-align: center; overflow: hidden; white-space: nowrap; width: 100%; text-overflow: ellipsis; }

/* 업그레이드 모달 */
#upgrade-modal { display: none; } 
.modal-title { font-size: 5vmin; margin-bottom: 3vh; color: #fff; text-shadow: 0 0 10px #fff; text-align: center; }
.card-container { 
    display: flex; gap: 3%; margin-bottom: 3vh; 
    width: 100%; justify-content: center; align-items: stretch; 
}

/* 카드 크기 반응형 */
.card { 
    width: 30%; 
    height: auto;
    aspect-ratio: 100/160;
    background: #333; border: 2px solid #fff; border-radius: 10px; 
    cursor: pointer; 
    display: flex; flex-direction: column; align-items: center; 
    padding: 1vh; 
    transition: transform 0.2s, background 0.2s; 
    position: relative; 
    box-sizing: border-box;
}
.card.disabled { opacity: 0.5; cursor: not-allowed; border-color: #555; transform: none; }
.highlighted { border: 4px solid #ffff00 !important; box-shadow: 0 0 20px #ffff00 !important; transform: scale(1.05) !important; z-index: 10; background: #444 !important; }
.card-icon { width: 8vmin; height: 8vmin; margin-bottom: 1vh; flex-shrink: 0; }
.card-name { font-size: 3vmin; font-weight: bold; margin-bottom: 0.5vh; color: #ffeb3b; text-align: center;}
.card-desc { font-size: 2.2vmin; color: #ccc; text-align: center; line-height: 1.2; flex-grow: 1; display: flex; align-items: center; justify-content: center; }
.card-level { margin-top: auto; font-size: 2.5vmin; color: #00f0ff; }
.key-badge { position: absolute; top: 5px; left: 5px; background: #fff; color: #000; font-size: 2vmin; padding: 2px 4px; border-radius: 4px; font-weight: bold; }
.max-badge { position: absolute; top: 5px; right: 5px; background: red; color: white; font-size: 2vmin; padding: 2px 4px; border-radius: 3px; font-weight: bold; }

#fixed-upgrade-container { display: flex; gap: 3%; border-top: 1px solid #555; padding-top: 2vh; width: 90%; justify-content: center; }
.fixed-btn { 
    width: 48%; 
    padding: 1.5vh; 
    background: #222; border: 2px solid #00f0ff; 
    color: white; font-size: 3vmin; font-weight: bold; 
    cursor: pointer; border-radius: 5px; transition: 0.2s; position: relative;
    white-space: nowrap;
}
.fixed-btn:hover { background: #00f0ff; color: black; }

#replace-ui { display: none; flex-direction: column; align-items: center; gap: 2vh; width: 100%; }
.replace-btn { 
    width: 80%; padding: 2vh; font-size: 3.5vmin; 
    background: #555; color: white; border: 2px solid white; 
    cursor: pointer; position: relative; 
}
.replace-btn:hover { background: #777; border-color: yellow; }
#btn-replace-cancel { width: 80%; background: #333; margin-top: 1vh; }